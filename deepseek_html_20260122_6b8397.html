<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Æ‡¶ø‡¶®‡¶ø ‡¶¶‡¶æ‡¶∞‡¶æ‡¶ú ‡¶∂‡¶™</title>
    <!-- Previous styles remain same -->
    <style>
        /* Previous styles remain same */
        
        /* Admin Panel Button */
        .admin-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            z-index: 999;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .admin-panel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 1001;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .order-item {
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
        }
        
        .order-badge {
            background: #ff3838;
            color: white;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <!-- Previous HTML content remains same -->
    
    <!-- Admin Panel -->
    <div class="admin-btn" onclick="openAdminPanel()">
        üë®‚Äçüíº ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶®
    </div>
    
    <div class="admin-panel" id="admin-panel">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤</h2>
            <span onclick="closeAdminPanel()" style="cursor: pointer; font-size: 24px;">√ó</span>
        </div>
        
        <div style="margin-bottom: 20px;">
            <input type="password" id="admin-pass" placeholder="‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°" 
                   style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
            <button onclick="loginAdmin()" style="width: 100%; padding: 12px; background: #333; color: white; border: none; border-radius: 5px; margin-top: 10px;">
                ‡¶≤‡¶ó‡¶á‡¶®
            </button>
        </div>
        
        <div id="admin-content" style="display: none;">
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button onclick="viewOrders()" style="flex: 1; padding: 10px; background: #ff3838; color: white; border: none; border-radius: 5px;">
                    ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                </button>
                <button onclick="exportOrders()" style="flex: 1; padding: 10px; background: #28a745; color: white; border: none; border-radius: 5px;">
                    ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
            </div>
            
            <div id="orders-list">
                <!-- Orders will be displayed here -->
            </div>
            
            <div style="margin-top: 20px;">
                <h4>‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</h4>
                <input type="email" id="admin-email" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤" 
                       style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd;">
                <button onclick="saveEmail()" style="width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 5px;">
                    ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Previous JavaScript code remains same
        
        // Admin Panel Functions
        const ADMIN_PASSWORD = "admin123"; // Change this to your password
        
        let orders = JSON.parse(localStorage.getItem('orders')) || [];
        let adminEmail = localStorage.getItem('adminEmail') || '';
        
        function openAdminPanel() {
            document.getElementById('admin-panel').style.display = 'block';
        }
        
        function closeAdminPanel() {
            document.getElementById('admin-panel').style.display = 'none';
        }
        
        function loginAdmin() {
            const password = document.getElementById('admin-pass').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('admin-content').style.display = 'block';
                loadOrders();
            } else {
                alert("‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°!");
            }
        }
        
        function loadOrders() {
            const ordersList = document.getElementById('orders-list');
            ordersList.innerHTML = '';
            
            if (orders.length === 0) {
                ordersList.innerHTML = '<p style="text-align: center; color: #888;">‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶®‡ßá‡¶á</p>';
                return;
            }
            
            orders.reverse().forEach((order, index) => {
                const orderDate = new Date(order.timestamp).toLocaleString('bn-BD');
                const orderHTML = `
                    <div class="order-item">
                        <div style="display: flex; justify-content: space-between;">
                            <strong>‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ #${orders.length - index}</strong>
                            <span class="order-badge">${order.status}</span>
                        </div>
                        <p>‡¶®‡¶æ‡¶Æ: ${order.name}</p>
                        <p>‡¶´‡ßã‡¶®: ${order.phone}</p>
                        <p>‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ: ${order.address}</p>
                        <p>‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü: ${order.payment}</p>
                        <p>‡¶Æ‡ßã‡¶ü: ‡ß≥${order.total}</p>
                        <p>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${orderDate}</p>
                        <div style="margin-top: 10px;">
                            <button onclick="updateStatus(${index}, 'Confirmed')" style="padding: 5px 10px; background: #28a745; color: white; border: none; border-radius: 3px; margin-right: 5px;">
                                ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ
                            </button>
                            <button onclick="updateStatus(${index}, 'Delivered')" style="padding: 5px 10px; background: #007bff; color: white; border: none; border-radius: 3px; margin-right: 5px;">
                                ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø
                            </button>
                            <button onclick="deleteOrder(${index})" style="padding: 5px 10px; background: #dc3545; color: white; border: none; border-radius: 3px;">
                                ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü
                            </button>
                        </div>
                    </div>
                `;
                ordersList.innerHTML += orderHTML;
            });
        }
        
        function updateStatus(index, status) {
            orders[index].status = status;
            localStorage.setItem('orders', JSON.stringify(orders));
            loadOrders();
            showNotification(`‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ "${status}" ‡¶§‡ßá ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá`);
        }
        
        function deleteOrder(index) {
            if (confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
                orders.splice(index, 1);
                localStorage.setItem('orders', JSON.stringify(orders));
                loadOrders();
                showNotification("‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá");
            }
        }
        
        function viewOrders() {
            loadOrders();
        }
        
        function exportOrders() {
            if (orders.length === 0) {
                alert("‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶®‡ßá‡¶á!");
                return;
            }
            
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Order ID,Name,Phone,Address,Payment,Total,Status,Date\n";
            
            orders.forEach((order, index) => {
                const row = [
                    `ORD${1000 + index}`,
                    order.name,
                    order.phone,
                    order.address,
                    order.payment,
                    order.total,
                    order.status,
                    new Date(order.timestamp).toLocaleString()
                ].join(",");
                csvContent += row + "\n";
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "orders.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function saveEmail() {
            const email = document.getElementById('admin-email').value;
            if (email) {
                adminEmail = email;
                localStorage.setItem('adminEmail', email);
                alert("‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!");
            }
        }
        
        // Modify the order submission function
        document.getElementById('order-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (cart.length === 0) {
                alert("‡¶ï‡¶æ‡¶∞‡ßç‡¶ü‡ßá ‡¶ï‡ßã‡¶®‡ßã ‡¶™‡¶£‡ßç‡¶Ø ‡¶®‡ßá‡¶á!");
                return;
            }
            
            if (!selectedPayment) {
                alert("‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!");
                return;
            }
            
            const formData = new FormData(this);
            const orderData = {
                name: formData.get('name'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                payment: selectedPayment,
                items: [...cart],
                total: document.getElementById('cart-total').textContent,
                status: "Pending",
                timestamp: new Date().toISOString()
            };
            
            // Save order to localStorage
            orders.push(orderData);
            localStorage.setItem('orders', JSON.stringify(orders));
            
            // Send email notification (if email is set)
            if (adminEmail) {
                sendEmailNotification(orderData);
            }
            
            // Send WhatsApp notification
            sendWhatsAppNotification(orderData);
            
            // Show confirmation
            const orderNumber = orders.length;
            alert(`‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶´‡¶≤!\n\n‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞: #ORD${1000 + orderNumber}\n‡¶®‡¶æ‡¶Æ: ${orderData.name}\n‡¶Æ‡ßã‡¶ü: ‡ß≥${orderData.total}\n\n‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶ü‡¶ø ‡¶∞‡¶ø‡¶∏‡¶ø‡¶≠ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`);
            
            // Reset cart and form
            cart = [];
            updateCart();
            this.reset();
            closeCart();
            
            // Reset payment selection
            document.querySelectorAll('.payment-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            selectedPayment = null;
        });
        
        // Email Notification using EmailJS
        function sendEmailNotification(orderData) {
            // You need to sign up at https://www.emailjs.com/
            // Free plan available - 200 emails/month
            
            // Add this script in head section:
            // <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
            
            if (typeof emailjs === 'undefined') {
                console.log("EmailJS not loaded");
                return;
            }
            
            const templateParams = {
                to_email: adminEmail,
                order_number: `ORD${1000 + orders.length}`,
                customer_name: orderData.name,
                customer_phone: orderData.phone,
                customer_address: orderData.address,
                payment_method: orderData.payment,
                total_amount: orderData.total,
                order_date: new Date().toLocaleString('bn-BD'),
                items: orderData.items.map(item => 
                    `${item.name} x ${item.quantity} = ‡ß≥${item.price * item.quantity}`
                ).join('\n')
            };
            
            // Initialize EmailJS with your User ID
            emailjs.init('YOUR_USER_ID'); // Replace with your EmailJS User ID
            
            emailjs.send('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', templateParams)
                .then(response => {
                    console.log('Email sent successfully:', response);
                })
                .catch(error => {
                    console.error('Email sending failed:', error);
                });
        }
        
        // WhatsApp Notification
        function sendWhatsAppNotification(orderData) {
            // Replace with your WhatsApp number
            const whatsappNumber = "88017XXXXXXXX"; // Your number
            const message = `*‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞!*\n\n‡¶®‡¶æ‡¶Æ: ${orderData.name}\n‡¶´‡ßã‡¶®: ${orderData.phone}\n‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ: ${orderData.address}\n‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü: ${orderData.payment}\n‡¶Æ‡ßã‡¶ü: ‡ß≥${orderData.total}\n\n‡¶Ü‡¶á‡¶ü‡ßá‡¶Æ:\n${orderData.items.map(item => `- ${item.name} x ${item.quantity}`).join('\n')}`;
            
            const encodedMessage = encodeURIComponent(message);
            const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
            
            // Open WhatsApp in new tab (customer will see this)
            window.open(whatsappURL, '_blank');
        }
        
        // Load admin email on page load
        if (adminEmail) {
            document.getElementById('admin-email').value = adminEmail;
        }
        
        // Auto-check for new orders every 30 seconds
        setInterval(() => {
            const lastOrderCount = localStorage.getItem('lastOrderCount') || 0;
            if (orders.length > lastOrderCount) {
                showNotification(`‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞! ‡¶Æ‡ßã‡¶ü ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞: ${orders.length}`);
                localStorage.setItem('lastOrderCount', orders.length);
                
                // Play notification sound
                playNotificationSound();
            }
        }, 30000);
        
        function playNotificationSound() {
            const audio = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3');
            audio.play().catch(e => console.log("Audio play failed:", e));
        }
        
        // Initialize
        window.onload = function() {
            // Previous initialization code
            
            // Check for new orders
            const newOrders = localStorage.getItem('newOrders');
            if (newOrders) {
                showNotification("‡¶®‡¶§‡ßÅ‡¶® ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶õ‡ßá! ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®");
            }
        };
    </script>
</body>
</html>